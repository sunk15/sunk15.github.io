<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¤©å¹²åœ°æ”¯äº”è¡Œå±æ€§ç»Ÿè®¡</title>
    <!-- å®Œå…¨ç§»é™¤å¤–éƒ¨CDNï¼Œå†…ç½®æ ¸å¿ƒæ ·å¼ -->
    <style>
        /* åŸºç¡€é‡ç½® */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { 
            background-color: #f8f4e9; 
            min-height: 100vh; 
            font-family: "SimHei", "Microsoft YaHei", serif; 
            color: #4a3520; 
            line-height: 1.6;
        }
        .container { max-width: 1200px; margin: 0 auto; padding: 0 15px; }
        
        /* å¤´éƒ¨æ ·å¼ */
        header {
            background-color: #4a3520;
            color: white;
            padding: 20px 0;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
            text-align: center;
        }
        header h1 { font-size: 28px; margin-bottom: 10px; }
        header p { color: #e8d9b5; font-size: 16px; }
        
        /* ä¸»å†…å®¹æ ·å¼ */
        main { padding: 30px 0; }
        .grid-layout {
            display: grid;
            grid-template-columns: 1fr;
            gap: 20px;
        }
        @media (min-width: 992px) {
            .grid-layout { grid-template-columns: 1fr 2fr; }
        }
        
        /* å¡ç‰‡æ ·å¼ */
        .card {
            background: white;
            border-radius: 12px;
            padding: 20px;
            box-shadow: 0 4px 12px rgba(107, 72, 38, 0.2);
            margin-bottom: 20px;
        }
        .card h2 {
            font-size: 22px;
            margin-bottom: 20px;
            padding-bottom: 10px;
            border-bottom: 1px solid #e8d9b5;
        }
        .card h3 { font-size: 18px; margin-bottom: 15px; color: #6b4826; }
        
        /* é€‰æ‹©é¡¹æ ·å¼ */
        .select-options {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 8px;
            margin-bottom: 25px;
        }
        .select-option {
            padding: 8px 10px;
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s;
            border-left: 3px solid #ccc;
        }
        .select-option:hover { background-color: #e8d9b5; }
        .select-option.active-option {
            background-color: #d4b589;
            font-weight: bold;
            color: #4a3520;
        }
        .select-option span.text-xs { font-size: 12px; color: #666; margin-left: 5px; }
        
        /* æŒ‰é’®æ ·å¼ */
        .btn-group { display: flex; gap: 10px; }
        .btn {
            flex: 1;
            padding: 10px 15px;
            border: none;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 16px;
            font-family: inherit;
        }
        .btn-reset {
            background-color: #6b4826;
            color: white;
        }
        .btn-reset:hover { background-color: #4a3520; }
        .btn-calc {
            background-color: #2ecc71;
            color: white;
        }
        .btn-calc:hover { background-color: #27ae60; }
        
        /* äº”è¡Œå¡ç‰‡æ ·å¼ */
        .elements-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(120px, 1fr));
            gap: 15px;
            margin-bottom: 20px;
        }
        .element-card {
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 4px 12px rgba(107, 72, 38, 0.2);
            transition: all 0.3s;
            border-left: 4px solid #ccc;
        }
        .element-card:hover { transform: scale(1.05); }
        .element-card h3 { margin-bottom: 8px; font-size: 16px; }
        .element-card .count { font-size: 24px; font-weight: bold; margin-bottom: 5px; }
        .element-card .items { font-size: 12px; color: #666; }
        
        /* äº”è¡Œé…è‰² */
        .wood { border-left-color: #2ecc71; background-color: rgba(46, 204, 113, 0.1); }
        .wood h3, .wood .count { color: #2ecc71; }
        .fire { border-left-color: #e74c3c; background-color: rgba(231, 76, 60, 0.1); }
        .fire h3, .fire .count { color: #e74c3c; }
        .earth { border-left-color: #f39c12; background-color: rgba(243, 156, 18, 0.1); }
        .earth h3, .earth .count { color: #f39c12; }
        .metal { border-left-color: #3498db; background-color: rgba(52, 152, 219, 0.1); }
        .metal h3, .metal .count { color: #3498db; }
        .water { border-left-color: #9b59b6; background-color: rgba(155, 89, 182, 0.1); }
        .water h3, .water .count { color: #9b59b6; }
        
        /* å›¾è¡¨å®¹å™¨ */
        .chart-container {
            height: 300px;
            background-color: #f8f4e9;
            border-radius: 8px;
            padding: 10px;
            margin-bottom: 20px;
        }
        
        /* å·²é€‰åˆ—è¡¨ */
        .selected-item {
            display: inline-block;
            padding: 4px 8px;
            border-radius: 4px;
            margin: 0 4px 4px 0;
            font-size: 14px;
        }
        
        /* é¡µè„šæ ·å¼ */
        footer {
            background-color: #4a3520;
            color: #e8d9b5;
            padding: 20px 0;
            text-align: center;
            margin-top: 30px;
        }
        footer p { margin-bottom: 5px; font-size: 14px; }
    </style>
    <!-- å†…ç½®Chart.jsæ ¸å¿ƒä»£ç ï¼ˆç²¾ç®€ç‰ˆï¼‰ -->
    <script>
        // Chart.js æç®€æ ¸å¿ƒï¼ˆä»…ä¿ç•™ç¯å½¢å›¾åŠŸèƒ½ï¼‰
        !function(t,e){"object"==typeof exports&&"undefined"!=typeof module?module.exports=e():"function"==typeof define&&define.amd?define(e):(t="undefined"!=typeof globalThis?globalThis:t||self).Chart=e()}(this,(function(){"use strict";const t={doughnut:{defaults:{cutout:"60%",radius:"100%",rotation:-90,circumference:360,animation:{animateRotate:!0,animateScale:!1}}}};class e{constructor(t){this.ctx=t,this.canvas=t.canvas,this.width=this.canvas.width,this.height=this.canvas.height}clear(){this.ctx.clearRect(0,0,this.width,this.height)}drawArc(t){const{ctx:e}=this,{x:i,y:n,radius:a,startAngle:s,endAngle:o,circumference:r,rotation:l,borderWidth:h,borderColor:d}=t;e.save(),e.beginPath();const u=(s-l)*Math.PI/180,c=(o-l)*Math.PI/180;e.arc(i,n,a,u,c),h&&(e.lineWidth=h,e.strokeStyle=d,e.stroke()),e.fill(),e.restore()}drawText(t){const{ctx:e}=this,{x:i,y:n,text:a,font:s,color:o}=t;e.save(),e.font=s,e.fillStyle=o,e.textAlign="center",e.textBaseline="middle",e.fillText(a,i,n),e.restore()}}class i{constructor(t,i){this.canvas=t,this.ctx=i,this.chartArea={left:0,right:t.width,top:0,bottom:t.height},this.plugins=[],this.data={datasets:[{data:[0,0,0,0,0],backgroundColor:["#2ecc71","#e74c3c","#f39c12","#3498db","#9b59b6"],borderWidth:1,borderColor:"#fff"}],labels:["æœ¨","ç«","åœŸ","é‡‘","æ°´"]},this.options=t={responsive:!0,maintainAspectRatio:!1,plugins:{legend:{position:"right",labels:{font:{size:14,family:'"SimHei", serif'},padding:20}},tooltip:{callbacks:{label:function(t){return`${t.label}: ${t.raw||0} ä¸ª`}}}},cutout:"60%"},this.renderer=new e(i)}update(){this.renderer.clear();const t=this.getDatasetMeta(0),i=this.calculateTotal(),n=this.options.cutout,a=parseInt(n)%100===0?parseInt(n)/100:parseFloat(n),s=this.chartArea,o=(s.right-s.left)/2,r=(s.bottom-s.top)/2,l=Math.min(o,r),h=l*1,h=l*a,d=this.options.rotation||-90,u=this.options.circumference||360;let c=0;for(let e=0;e<t.data.length;e++){const n=t.data[e],a=n/i*u,f=c+d,p=f+a;this.renderer.drawArc({x:o,y:r,radius:l,startAngle:f,endAngle:p,rotation:d,borderWidth:this.data.datasets[0].borderWidth,borderColor:this.data.datasets[0].borderColor,fillStyle:this.data.datasets[0].backgroundColor[e]}),c+=a}}getDatasetMeta(t){return{data:this.data.datasets[t].data}}calculateTotal(){return this.data.datasets[0].data.reduce((t,e)=>t+e,0)}updateData(t){this.data.datasets[0].data=t,this.update()}}return function(t,n){const a=t.getContext("2d"),s=new i(t,a);return s.update(),s}}));
    </script>
</head>
<body>
    <!-- é¡µé¢å¤´éƒ¨ -->
    <header>
        <div class="container">
            <h1>å¤©å¹²åœ°æ”¯äº”è¡Œå±æ€§ç»Ÿè®¡</h1>
            <p>é€‰æ‹©å¤©å¹²ã€åœ°æ”¯ï¼Œå®æ—¶ç»Ÿè®¡é‡‘æœ¨æ°´ç«åœŸå±æ€§åˆ†å¸ƒ</p>
        </div>
    </header>

    <!-- ä¸»è¦å†…å®¹ -->
    <main class="container">
        <div class="grid-layout">
            <!-- å·¦ä¾§é€‰æ‹©åŒº -->
            <div class="card">
                <h2>å±æ€§é€‰æ‹©</h2>
                
                <!-- å¤©å¹²é€‰æ‹© -->
                <div class="mb-8">
                    <h3>å¤©å¹²</h3>
                    <div class="select-options" id="tianGanList">
                        <!-- å¤©å¹²é€‰é¡¹åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <!-- åœ°æ”¯é€‰æ‹© -->
                <div class="mb-8">
                    <h3>åœ°æ”¯</h3>
                    <div class="select-options" id="diZhiList">
                        <!-- åœ°æ”¯é€‰é¡¹åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
                
                <!-- æ“ä½œæŒ‰é’® -->
                <div class="btn-group">
                    <button id="resetBtn" class="btn btn-reset">
                        <i>ğŸ”„</i> é‡ç½®é€‰æ‹©
                    </button>
                    <button id="calcBtn" class="btn btn-calc">
                        <i>ğŸ§®</i> ç»Ÿè®¡å±æ€§
                    </button>
                </div>
            </div>

            <!-- å³ä¾§ç»Ÿè®¡ç»“æœåŒº -->
            <div>
                <!-- äº”è¡Œå±æ€§å¡ç‰‡ -->
                <div class="card">
                    <h2>äº”è¡Œå±æ€§åˆ†å¸ƒ</h2>
                    
                    <div class="elements-grid">
                        <!-- æœ¨å±æ€§ -->
                        <div class="element-card wood">
                            <h3>æœ¨</h3>
                            <div class="count" id="woodCount">0</div>
                            <div class="items" id="woodItems">-</div>
                        </div>
                        
                        <!-- ç«å±æ€§ -->
                        <div class="element-card fire">
                            <h3>ç«</h3>
                            <div class="count" id="fireCount">0</div>
                            <div class="items" id="fireItems">-</div>
                        </div>
                        
                        <!-- åœŸå±æ€§ -->
                        <div class="element-card earth">
                            <h3>åœŸ</h3>
                            <div class="count" id="earthCount">0</div>
                            <div class="items" id="earthItems">-</div>
                        </div>
                        
                        <!-- é‡‘å±æ€§ -->
                        <div class="element-card metal">
                            <h3>é‡‘</h3>
                            <div class="count" id="metalCount">0</div>
                            <div class="items" id="metalItems">-</div>
                        </div>
                        
                        <!-- æ°´å±æ€§ -->
                        <div class="element-card water">
                            <h3>æ°´</h3>
                            <div class="count" id="waterCount">0</div>
                            <div class="items" id="waterItems">-</div>
                        </div>
                    </div>
                    
                    <!-- å¯è§†åŒ–å›¾è¡¨ -->
                    <div class="chart-container">
                        <canvas id="elementChart"></canvas>
                    </div>
                </div>
                
                <!-- å·²é€‰åˆ—è¡¨ -->
                <div class="card">
                    <h2>å·²é€‰å±æ€§åˆ—è¡¨</h2>
                    <div id="selectedList" class="text-lg">
                        <p style="color: #999; font-style: italic;">è¯·é€‰æ‹©å¤©å¹²/åœ°æ”¯åç‚¹å‡»ç»Ÿè®¡æŒ‰é’®</p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <!-- é¡µè„š -->
    <footer>
        <div class="container">
            <p>å¤©å¹²åœ°æ”¯äº”è¡Œå±æ€§ç»Ÿè®¡å·¥å…· Â© 2025</p>
            <p style="font-size: 12px;">äº”è¡Œå¯¹åº”ï¼šæœ¨(ç»¿)ã€ç«(çº¢)ã€åœŸ(é»„)ã€é‡‘(è“)ã€æ°´(ç´«)</p>
        </div>
    </footer>

    <script>
        // å¤©å¹²åœ°æ”¯äº”è¡Œæ•°æ®
        const wuxingData = {
            tianGan: [
                { name: 'ç”²', element: 'wood', color: '#2ecc71' },
                { name: 'ä¹™', element: 'wood', color: '#2ecc71' },
                { name: 'ä¸™', element: 'fire', color: '#e74c3c' },
                { name: 'ä¸', element: 'fire', color: '#e74c3c' },
                { name: 'æˆŠ', element: 'earth', color: '#f39c12' },
                { name: 'å·±', element: 'earth', color: '#f39c12' },
                { name: 'åºš', element: 'metal', color: '#3498db' },
                { name: 'è¾›', element: 'metal', color: '#3498db' },
                { name: 'å£¬', element: 'water', color: '#9b59b6' },
                { name: 'ç™¸', element: 'water', color: '#9b59b6' }
            ],
            diZhi: [
                { name: 'å­', element: 'water', color: '#9b59b6' },
                { name: 'ä¸‘', element: 'earth', color: '#f39c12' },
                { name: 'å¯…', element: 'wood', color: '#2ecc71' },
                { name: 'å¯', element: 'wood', color: '#2ecc71' },
                { name: 'è¾°', element: 'earth', color: '#f39c12' },
                { name: 'å·³', element: 'fire', color: '#e74c3c' },
                { name: 'åˆ', element: 'fire', color: '#e74c3c' },
                { name: 'æœª', element: 'earth', color: '#f39c12' },
                { name: 'ç”³', element: 'metal', color: '#3498db' },
                { name: 'é…‰', element: 'metal', color: '#3498db' },
                { name: 'æˆŒ', element: 'earth', color: '#f39c12' },
                { name: 'äº¥', element: 'water', color: '#9b59b6' }
            ]
        };

        // å…¨å±€å˜é‡
        let selectedItems = [];
        let chart = null;

        // é¡µé¢åŠ è½½å®Œæˆååˆå§‹åŒ–
        window.onload = function() {
            // å¼ºåˆ¶æ¸²æŸ“DOMï¼ˆè§£å†³éº’éºŸç³»ç»ŸDOMåŠ è½½å»¶è¿Ÿï¼‰
            document.body.style.display = 'block';
            
            // ç”Ÿæˆé€‰é¡¹
            renderOptions('tianGanList', wuxingData.tianGan);
            renderOptions('diZhiList', wuxingData.diZhi);
            
            // åˆå§‹åŒ–å›¾è¡¨ï¼ˆæç®€ç‰ˆChart.jsï¼‰
            initChart();
            
            // ç»‘å®šäº‹ä»¶
            bindEvents();
        };

        // æ¸²æŸ“é€‰é¡¹åˆ—è¡¨
        function renderOptions(containerId, data) {
            const container = document.getElementById(containerId);
            if (!container) return; // é˜²æ­¢DOMæœªæ‰¾åˆ°
            
            data.forEach(item => {
                const option = document.createElement('div');
                option.className = 'select-option';
                option.dataset.name = item.name;
                option.dataset.element = item.element;
                option.style.borderLeft = `3px solid ${item.color}`;
                option.innerHTML = `
                    <span class="font-bold">${item.name}</span>
                    <span class="text-xs ml-2 text-gray-500">${getElementName(item.element)}</span>
                `;
                
                // ç‚¹å‡»é€‰æ‹©/å–æ¶ˆ
                option.onclick = function() {
                    this.classList.toggle('active-option');
                    const isSelected = this.classList.contains('active-option');
                    
                    if (isSelected) {
                        selectedItems.push({
                            name: item.name,
                            element: item.element,
                            type: containerId === 'tianGanList' ? 'å¤©å¹²' : 'åœ°æ”¯'
                        });
                    } else {
                        selectedItems = selectedItems.filter(i => i.name !== item.name);
                    }
                };
                
                container.appendChild(option);
            });
        }

        // è·å–äº”è¡Œåç§°
        function getElementName(element) {
            const map = { wood: 'æœ¨', fire: 'ç«', earth: 'åœŸ', metal: 'é‡‘', water: 'æ°´' };
            return map[element] || '';
        }

        // åˆå§‹åŒ–å›¾è¡¨ï¼ˆé€‚é…æç®€ç‰ˆChart.jsï¼‰
        function initChart() {
            const ctx = document.getElementById('elementChart');
            if (ctx) {
                chart = new Chart(ctx);
            }
        }

        // ç»‘å®šäº‹ä»¶
        function bindEvents() {
            // ç»Ÿè®¡æŒ‰é’®
            document.getElementById('calcBtn').onclick = calculateElements;
            
            // é‡ç½®æŒ‰é’®
            document.getElementById('resetBtn').onclick = function() {
                document.querySelectorAll('.select-option').forEach(option => {
                    option.classList.remove('active-option');
                });
                selectedItems = [];
                resetResult();
                chart && chart.updateData([0,0,0,0,0]);
                document.getElementById('selectedList').innerHTML = '<p style="color: #999; font-style: italic;">è¯·é€‰æ‹©å¤©å¹²/åœ°æ”¯åç‚¹å‡»ç»Ÿè®¡æŒ‰é’®</p>';
            };
        }

        // ç»Ÿè®¡äº”è¡Œå±æ€§
        function calculateElements() {
            if (selectedItems.length === 0) {
                alert('è¯·å…ˆé€‰æ‹©è‡³å°‘ä¸€ä¸ªå¤©å¹²æˆ–åœ°æ”¯ï¼');
                return;
            }

            // åˆå§‹åŒ–ç»Ÿè®¡ç»“æœ
            const result = {
                wood: { count: 0, items: [] },
                fire: { count: 0, items: [] },
                earth: { count: 0, items: [] },
                metal: { count: 0, items: [] },
                water: { count: 0, items: [] }
            };

            // ç»Ÿè®¡æ•°æ®
            selectedItems.forEach(item => {
                result[item.element].count++;
                result[item.element].items.push(`${item.type}${item.name}`);
            });

            // æ›´æ–°æ˜¾ç¤º
            updateResultDisplay(result);
            
            // æ›´æ–°å›¾è¡¨
            const chartData = [
                result.wood.count,
                result.fire.count,
                result.earth.count,
                result.metal.count,
                result.water.count
            ];
            chart && chart.updateData(chartData);
            
            // æ›´æ–°é€‰ä¸­åˆ—è¡¨
            updateSelectedList();
        }

        // æ›´æ–°ç»Ÿè®¡ç»“æœæ˜¾ç¤º
        function updateResultDisplay(result) {
            document.getElementById('woodCount').textContent = result.wood.count;
            document.getElementById('fireCount').textContent = result.fire.count;
            document.getElementById('earthCount').textContent = result.earth.count;
            document.getElementById('metalCount').textContent = result.metal.count;
            document.getElementById('waterCount').textContent = result.water.count;
            
            document.getElementById('woodItems').textContent = result.wood.items.join('ã€') || '-';
            document.getElementById('fireItems').textContent = result.fire.items.join('ã€') || '-';
            document.getElementById('earthItems').textContent = result.earth.items.join('ã€') || '-';
            document.getElementById('metalItems').textContent = result.metal.items.join('ã€') || '-';
            document.getElementById('waterItems').textContent = result.water.items.join('ã€') || '-';
        }

        // é‡ç½®ç»Ÿè®¡ç»“æœ
        function resetResult() {
            document.getElementById('woodCount').textContent = '0';
            document.getElementById('fireCount').textContent = '0';
            document.getElementById('earthCount').textContent = '0';
            document.getElementById('metalCount').textContent = '0';
            document.getElementById('waterCount').textContent = '0';
            
            document.getElementById('woodItems').textContent = '-';
            document.getElementById('fireItems').textContent = '-';
            document.getElementById('earthItems').textContent = '-';
            document.getElementById('metalItems').textContent = '-';
            document.getElementById('waterItems').textContent = '-';
        }

        // æ›´æ–°é€‰ä¸­åˆ—è¡¨
        function updateSelectedList() {
            const listContainer = document.getElementById('selectedList');
            if (selectedItems.length === 0) {
                listContainer.innerHTML = '<p style="color: #999; font-style: italic;">è¯·é€‰æ‹©å¤©å¹²/åœ°æ”¯åç‚¹å‡»ç»Ÿè®¡æŒ‰é’®</p>';
                return;
            }

            // åˆ†ç»„æ˜¾ç¤º
            const tianGanItems = selectedItems.filter(item => item.type === 'å¤©å¹²');
            const diZhiItems = selectedItems.filter(item => item.type === 'åœ°æ”¯');

            let html = `
                <div style="margin-bottom: 15px;">
                    <h4 style="font-weight: bold; margin-bottom: 8px;">å¤©å¹²ï¼š</h4>
                    <p>${tianGanItems.map(item => `<span class="selected-item" style="background-color: ${item.element === 'wood' ? '#2ecc711a' : item.element === 'fire' ? '#e74c3c1a' : item.element === 'earth' ? '#f39c121a' : item.element === 'metal' ? '#3498db1a' : '#9b59b61a'}; color: ${item.element === 'wood' ? '#2ecc71' : item.element === 'fire' ? '#e74c3c' : item.element === 'earth' ? '#f39c12' : item.element === 'metal' ? '#3498db' : '#9b59b6'}">${item.name}</span>`).join(' ') || 'æ— '}</p>
                </div>
                <div>
                    <h4 style="font-weight: bold; margin-bottom: 8px;">åœ°æ”¯ï¼š</h4>
                    <p>${diZhiItems.map(item => `<span class="selected-item" style="background-color: ${item.element === 'wood' ? '#2ecc711a' : item.element === 'fire' ? '#e74c3c1a' : item.element === 'earth' ? '#f39c121a' : item.element === 'metal' ? '#3498db1a' : '#9b59b61a'}; color: ${item.element === 'wood' ? '#2ecc71' : item.element === 'fire' ? '#e74c3c' : item.element === 'earth' ? '#f39c12' : item.element === 'metal' ? '#3498db' : '#9b59b6'}">${item.name}</span>`).join(' ') || 'æ— '}</p>
                </div>
            `;
            
            listContainer.innerHTML = html;
        }
    </script>
</body>
</html>
