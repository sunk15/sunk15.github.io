<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>时间戳转换工具</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }

        body {
            background-color: #f5f7fa;
            padding: 20px;
            color: #333;
            line-height: 1.6;
        }

        .container {
            max-width: 900px; /* 加宽容器宽度 */
            margin: 0 auto;
            background: white;
            border-radius: 10px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
            color: white;
            padding: 20px;
            text-align: center;
            font-size: 20px;
            font-weight: 600;
        }

        .content {
            padding: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #495057;
        }

        input, select {
            width: 100%;
            padding: 12px 15px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
            transition: all 0.2s ease;
        }

        input:focus, select:focus {
            outline: none;
            border-color: #4facfe;
            box-shadow: 0 0 0 0.2rem rgba(79, 172, 254, 0.25);
        }

        .btn-group {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            margin: 20px 0;
        }

        .btn {
            flex: 1;
            min-width: 120px;
            padding: 12px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            color: white;
        }

        .btn-primary {
            background-color: #007bff;
        }

        .btn-primary:hover {
            background-color: #0056b3;
        }

        .btn-success {
            background-color: #28a745;
        }

        .btn-success:hover {
            background-color: #1e7e34;
        }

        .btn-info {
            background-color: #17a2b8;
        }

        .btn-info:hover {
            background-color: #138496;
        }

        .btn-warning {
            background-color: #ffc107;
            color: #212529;
        }

        .btn-warning:hover {
            background-color: #e0a800;
        }

        .result-card {
            background-color: #f8f9fa;
            border-radius: 6px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #4facfe;
        }

        /* 核心优化：调整结果项布局，防止标题换行 */
        .result-item {
            display: flex;
            align-items: center; /* 垂直居中对齐 */
            margin-bottom: 15px;
            padding-bottom: 15px;
            border-bottom: 1px dashed #e9ecef;
            min-height: 45px; /* 增加最小高度 */
        }

        .result-item:last-child {
            margin-bottom: 0;
            padding-bottom: 0;
            border-bottom: none;
        }

        /* 关键修改：大幅加宽标签宽度，确保「13位时间戳（毫秒）：」完整显示 */
        .result-label {
            flex: 0 0 160px; /* 从140px加宽到160px，足够容纳完整标题 */
            font-weight: 600;
            color: #6c757d;
            white-space: nowrap; /* 强制不换行 */
            overflow: visible; /* 取消溢出隐藏，确保文字完整显示 */
            font-size: 14px;
        }

        /* 内容区域自适应，复制按钮跟随 */
        .result-value {
            flex: 1;
            color: #212529;
            word-break: break-all;
            display: flex;
            align-items: center;
            font-size: 14px;
            padding-right: 10px; /* 增加右侧内边距 */
        }

        .copy-btn {
            background: none;
            border: none;
            color: #007bff;
            cursor: pointer;
            font-size: 13px;
            margin-left: 10px;
            opacity: 0.8;
            white-space: nowrap; /* 复制按钮不换行 */
            padding: 4px 8px; /* 增加点击区域 */
            border-radius: 3px;
            transition: all 0.2s;
        }

        .copy-btn:hover {
            opacity: 1;
            text-decoration: underline;
            background-color: rgba(0, 123, 255, 0.05);
        }

        .message {
            margin-top: 15px;
            padding: 10px;
            border-radius: 4px;
            font-size: 14px;
            display: none;
            text-align: center;
        }

        .success-msg {
            background-color: #d4edda;
            color: #155724;
        }

        .error-msg {
            background-color: #f8d7da;
            color: #721c24;
        }

        .footer {
            padding: 15px;
            text-align: center;
            font-size: 13px;
            color: #6c757d;
            border-top: 1px solid #e9ecef;
            margin-top: 20px;
        }

        /* 响应式优化：小屏幕下调整布局，仍保证一行显示 */
        @media (max-width: 576px) {
            .content {
                padding: 20px;
            }

            .btn {
                min-width: 100%;
            }

            /* 小屏幕也保证标签足够宽，仅微调字体 */
            .result-label {
                flex: 0 0 140px;
                font-size: 13px;
            }

            .result-value {
                font-size: 13px;
            }
        }

        /* 适配平板等中等屏幕 */
        @media (min-width: 577px) and (max-width: 768px) {
            .result-label {
                flex: 0 0 150px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">时间戳转换工具</div>
        
        <div class="content">
            <div class="form-group">
                <label class="form-label" for="timestampInput">时间戳（支持10位/13位，秒/毫秒）</label>
                <input type="text" id="timestampInput" placeholder="请输入时间戳，例如：1735689600 或 1735689600000">
            </div>

            <div class="form-group">
                <label class="form-label" for="timeTypeSelect">时间类型</label>
                <select id="timeTypeSelect">
                    <option value="local">本地时间</option>
                    <option value="utc">UTC时间</option>
                </select>
            </div>

            <div class="btn-group">
                <button class="btn btn-primary" id="convertBtn">转换为可读时间</button>
                <button class="btn btn-success" id="currentTimestampBtn">获取当前时间戳</button>
                <button class="btn btn-info" id="clearBtn">清空内容</button>
            </div>

            <div class="message success-msg" id="successMsg">操作成功！</div>
            <div class="message error-msg" id="errorMsg">输入的时间戳格式不正确，请检查！</div>

            <div class="result-card" id="resultCard" style="display: none;">
                <div class="result-item">
                    <div class="result-label">10位时间戳（秒）：</div>
                    <div class="result-value" id="timestamp10">
                        <span>--</span>
                        <button class="copy-btn" data-target="timestamp10">复制</button>
                    </div>
                </div>
                <div class="result-item">
                    <div class="result-label">13位时间戳（毫秒）：</div>
                    <div class="result-value" id="timestamp13">
                        <span>--</span>
                        <button class="copy-btn" data-target="timestamp13">复制</button>
                    </div>
                </div>
                <div class="result-item">
                    <div class="result-label">格式化时间：</div>
                    <div class="result-value" id="formatTime">
                        <span>--</span>
                        <button class="copy-btn" data-target="formatTime">复制</button>
                    </div>
                </div>
                <div class="result-item">
                    <div class="result-label">详细时间：</div>
                    <div class="result-value" id="detailTime">
                        <span>--</span>
                        <button class="copy-btn" data-target="detailTime">复制</button>
                    </div>
                </div>
            </div>
        </div>

        <div class="footer">
            支持10位（秒）和13位（毫秒）时间戳转换 | 本地时间/UTC时间切换
        </div>
    </div>

    <script>
        // 获取DOM元素
        const timestampInput = document.getElementById('timestampInput');
        const timeTypeSelect = document.getElementById('timeTypeSelect');
        const convertBtn = document.getElementById('convertBtn');
        const currentTimestampBtn = document.getElementById('currentTimestampBtn');
        const clearBtn = document.getElementById('clearBtn');
        const resultCard = document.getElementById('resultCard');
        const successMsg = document.getElementById('successMsg');
        const errorMsg = document.getElementById('errorMsg');
        
        // 结果元素
        const timestamp10 = document.getElementById('timestamp10').querySelector('span');
        const timestamp13 = document.getElementById('timestamp13').querySelector('span');
        const formatTime = document.getElementById('formatTime').querySelector('span');
        const detailTime = document.getElementById('detailTime').querySelector('span');
        
        // 复制按钮
        const copyBtns = document.querySelectorAll('.copy-btn');

        // 转换时间戳为可读时间
        convertBtn.addEventListener('click', () => {
            const input = timestampInput.value.trim();
            hideAllMessages();
            
            if (!input) {
                showMessage(errorMsg, '请输入时间戳！');
                return;
            }

            // 验证时间戳格式（数字且长度为10或13位）
            if (!/^\d+$/.test(input) || (input.length !== 10 && input.length !== 13)) {
                showMessage(errorMsg, '时间戳格式错误，应为10位（秒）或13位（毫秒）数字！');
                return;
            }

            try {
                // 统一转换为毫秒级时间戳
                let timestamp = parseInt(input);
                if (input.length === 10) {
                    timestamp *= 1000;
                }

                // 获取时间类型（本地/UTC）
                const timeType = timeTypeSelect.value;
                const date = new Date(timestamp);

                // 格式化时间
                updateResult(timestamp, date, timeType);
                resultCard.style.display = 'block';
                showMessage(successMsg, '转换成功！');
            } catch (e) {
                showMessage(errorMsg, '转换失败，请检查时间戳是否有效！');
                console.error('转换失败:', e);
            }
        });

        // 获取当前时间戳
        currentTimestampBtn.addEventListener('click', () => {
            hideAllMessages();
            const now = new Date();
            const timeType = timeTypeSelect.value;
            
            // 当前时间戳（毫秒）
            const ts13 = now.getTime();
            // 当前时间戳（秒）
            const ts10 = Math.floor(ts13 / 1000);

            // 更新输入框和结果
            timestampInput.value = ts13;
            updateResult(ts13, now, timeType);
            resultCard.style.display = 'block';
            showMessage(successMsg, '已获取当前时间戳！');
        });

        // 清空内容
        clearBtn.addEventListener('click', () => {
            timestampInput.value = '';
            resultCard.style.display = 'none';
            hideAllMessages();
            
            // 重置结果
            timestamp10.textContent = '--';
            timestamp13.textContent = '--';
            formatTime.textContent = '--';
            detailTime.textContent = '--';
        });

        // 复制功能（修复兼容性问题）
        copyBtns.forEach(btn => {
            btn.addEventListener('click', async (e) => {
                e.preventDefault(); // 阻止默认行为
                const targetId = e.target.getAttribute('data-target');
                const text = document.getElementById(targetId).querySelector('span').textContent;
                
                if (text === '--') {
                    showMessage(errorMsg, '暂无可复制的内容！');
                    return;
                }

                try {
                    // 方案1：优先使用Clipboard API
                    await navigator.clipboard.writeText(text);
                    showMessage(successMsg, '复制成功！');
                } catch (err) {
                    // 方案2：降级使用文本域复制（兼容老浏览器/非安全上下文）
                    try {
                        const textArea = document.createElement('textarea');
                        textArea.value = text;
                        textArea.style.position = 'fixed'; // 防止滚动条跳动
                        textArea.style.left = '-999999px';
                        textArea.style.top = '-999999px';
                        document.body.appendChild(textArea);
                        textArea.focus();
                        textArea.select();
                        document.execCommand('copy');
                        document.body.removeChild(textArea);
                        showMessage(successMsg, '复制成功！');
                    } catch (fallbackErr) {
                        showMessage(errorMsg, '复制失败，请手动复制！');
                        console.error('复制失败:', fallbackErr);
                    }
                }
            });
        });

        // 更新结果显示
        function updateResult(timestamp, date, timeType) {
            // 10位时间戳（秒）
            timestamp10.textContent = Math.floor(timestamp / 1000);
            // 13位时间戳（毫秒）
            timestamp13.textContent = timestamp;

            // 格式化时间
            if (timeType === 'local') {
                // 本地时间
                formatTime.textContent = date.toLocaleString();
                detailTime.textContent = `${date.getFullYear()}-${padZero(date.getMonth() + 1)}-${padZero(date.getDate())} ${padZero(date.getHours())}:${padZero(date.getMinutes())}:${padZero(date.getSeconds())}.${padZero(date.getMilliseconds(), 3)}`;
            } else {
                // UTC时间
                formatTime.textContent = date.toUTCString();
                detailTime.textContent = `${date.getUTCFullYear()}-${padZero(date.getUTCMonth() + 1)}-${padZero(date.getUTCDate())} ${padZero(date.getUTCHours())}:${padZero(date.getUTCMinutes())}:${padZero(date.getUTCSeconds())}.${padZero(date.getUTCMilliseconds(), 3)} (UTC)`;
            }
        }

        // 补零函数
        function padZero(num, length = 2) {
            return num.toString().padStart(length, '0');
        }

        // 显示提示信息
        function showMessage(element, text) {
            element.textContent = text;
            element.style.display = 'block';
            
            // 3秒后隐藏
            setTimeout(() => {
                element.style.display = 'none';
            }, 3000);
        }

        // 隐藏所有提示信息
        function hideAllMessages() {
            successMsg.style.display = 'none';
            errorMsg.style.display = 'none';
        }
    </script>
</body>
</html>
